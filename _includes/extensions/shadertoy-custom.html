<!-- Custom Shadertoy Viewer -->
<div class="extensions extensions--video shadertoy-container" id="shadertoy-{{ include.id }}" style="position: relative; width: 100%; padding-bottom: 56.25%; background: #000;">
  <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"></div>
</div>

<!-- Load dependencies if not already loaded -->
<script>
  (function() {
    var shaderId = '{{ include.id }}';
    var containerId = 'shadertoy-' + shaderId;

    function initViewer() {
      if (typeof THREE === 'undefined' || typeof ShadertoyViewer === 'undefined') {
        setTimeout(initViewer, 100);
        return;
      }

      var container = document.getElementById(containerId);
      if (container && !container.dataset.initialized) {
        container.dataset.initialized = 'true';
        new ShadertoyViewer(containerId, shaderId, {
          autoplay: {{ include.autoplay | default: true }},
          showGui: {{ include.gui | default: true }}
        });
      }
    }

    // Start initialization
    initViewer();
  })();
</script>
